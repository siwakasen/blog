name: ðŸš€ Deploy To Kubernetes
on: workflow_dispatch

jobs:
  deploy:
    name: deploy to Kubernetes
    runs-on: self-hosted
    steps:
      - uses: actions/checkout@master
      - name: deploy to Kubernetes
        uses: steebchen/kubectl@v2.0.0
        with: # defaults to latest kubectl binary version
          config: ${{ secrets.KUBE_CONFIG }}
          command: rollout restart deployment/${{ vars.DEPLOYMENT_NAME }} -n ${{ vars.DEPLOYMENT_NAMESPACES }}
      - name: verify deployment
        uses: steebchen/kubectl@v2.0.0
        with:
          config: ${{ secrets.KUBE_CONFIG }}
          version: v1.21.0 # specify kubectl binary version explicitly
          binaries-url: "https://dl.k8s.io/release/v1.21.0/bin/linux/amd64/kubectl" # specify the download url explicitly
          command: rollout status deployment/${{ vars.DEPLOYMENT_NAME }} -n ${{ vars.DEPLOYMENT_NAMESPACES }}
